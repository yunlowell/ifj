{% extends "base.html" %}
{% load static %}

{% block content %}
<h1>{{ member.username }}의 프로필 페이지</h1>
<div>
    <!-- 내 프로필에서는 팔로우 버튼 안 보이게 하기 -->
    {% if request.user != member %}
    <!-- 팔로우 언팔로우 기능 -->
    <form action="{% url 'users:follow' member.pk %}" method="POST">
        {% csrf_token %}

        {% if request.user in member.followers.all %}
            <input type="submit" value="언팔로우">
        {% else %}
            <input type="submit" value="팔로우">
        {% endif %}
    </form>
    {% endif %}
</div>

{% if request.user.profile_image %}
    <img src="{{ member.profile_image.url }}" alt="User Profile Image" width="150">
{% else %}
    <img src="{% static 'users/user.png' %}" alt="Default Profile Image" width="150">
{% endif %}

<h3>Uesrname: {{ member.username }}</h3>
<h5>가입일: {{ user.date_joined|date:"Y년 m월 d일" }} </h5>
<!-- 팔로워 팔로잉 숫자 표시 -->
<p>팔로워: {{ followers_count }}</p>
<p>팔로잉: {{ following_count }}</p>
<h2>{{ member.username }}님이 작성한 글</h2>
    <ul>
        <!-- 내가 작성한 글 보여주기, 제목만 보이게 누르면 그 글로 이동 -->
        {% for article in articles %}
            <li>
                <a href="{% url 'articles:article_detail' article.pk %}">{{ article.title }}</a>
            </li>
        <!-- 작성된 글이 없을 때 문구 띄우고 글 작성하러 가기 링크 추가 -->
        {% empty %} 
            <li>아직 작성된 글이 없습니다.</li>
            <a href="{% url 'articles:create' %}">글 작성하러 가기</a>

        {% endfor %}
    </ul>

<h2>{{ member.username }}님이 찜한 글</h2>
    <ul>
        {% for article in liked_articles %}
            <li>
                <a href="{% url 'articles:article_detail' article.pk %}">{{ article.title }} </a>
            </li>
        {% empty %}
            <li> 아직 찜한 글이 없습니다. </li>
            <a href="{% url 'articles:articles' %}">글 둘러보기</a>
        
        {% endfor %}
    </ul>

<a href="{% url 'accounts:update' %}">회원정보수정</a>

<form action="{% url 'accounts:delete' %}" method="POST">
    {% csrf_token %}
    <input type="submit" value="회원탈퇴">
</form>
{% endblock content %}